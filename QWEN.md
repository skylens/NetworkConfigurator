---

## 🎯 任务：创建 .NET Framework 命令行工具 —— 网卡IP配置管理器

### ✅ 功能需求

请创建一个基于 **.NET Framework** 的 **命令行应用程序（Console Application）**，实现以下功能：

1. **列出所有可用网卡**（仅启用且支持 IPv4 的适配器），并让用户**交互式选择**一个网卡。
2. **读取所选网卡当前的动态IP配置**，包括：
   - IPv4 地址
   - 子网掩码
   - 默认网关
   - DNS 服务器地址（可能多个）
3. **将当前动态IP配置转换为静态IP配置**（即：保留当前IP、掩码、网关，但改为手动设置）。
4. **支持自定义 DNS 配置**：
   - 通过命令行参数 `--SetDNS` 指定一个或多个 DNS 服务器，例如：
     ```
     --SetDNS 10.0.0.1
     --SetDNS 10.0.0.1,10.0.0.2
     ```
   - 如果未指定 `--SetDNS`，则**自动沿用当前获取到的DNS服务器列表**。
5. **操作前需提示用户确认**，避免误操作。
6. **成功设置后输出结果信息**，失败时输出错误原因。
7. **支持国际化**：
   - 在中文系统上运行时显示中文界面
   - 在其他语言系统上运行时显示英文界面

---

### 🧩 技术要求

- 使用 **.NET Framework 4.x**（兼容 Windows 系统内置环境）。
- 使用 `System.Net.NetworkInformation` 获取网卡信息。
- 使用 `WMI (ManagementClass/ManagementObject)` 或 `netsh` 命令行调用（推荐 WMI）来设置静态 IP 和 DNS。
- **不使用第三方库**。
- 支持中文提示（控制台输出使用 UTF-8 或系统默认编码）。
- 参数解析需支持大小写不敏感（如 `--setdns` 应等效于 `--SetDNS`）。

---

### 🖥️ 示例运行

```bash
# 示例1：设置静态IP，DNS使用当前自动获取的
MyIpConfigTool.exe

# 示例2：设置静态IP，并指定自定义DNS
MyIpConfigTool.exe --SetDNS 8.8.8.8,8.8.4.4
```

---

### 📋 输出示例

```
检测到以下可用网卡：
[1] 以太网适配器 本地连接
[2] 无线网络连接

请选择网卡编号 [1-2]: 1

当前配置：
IP: 192.168.1.100
子网掩码: 255.255.255.0
网关: 192.168.1.1
DNS: 192.168.1.1

是否将此配置设为静态？(Y/N): Y

设置成功！当前网卡已配置为静态IP。
DNS 服务器: 192.168.1.1
```

---

### ⚠️ 注意事项

- 必须以**管理员权限运行程序**，否则设置会失败。
- 设置失败时，应捕获异常并友好提示（如“权限不足”或“参数无效”）。
- 不支持 IPv6，仅处理 IPv4。
- 若网卡当前无IP（如未连接），应提示“未获取到有效IP配置，无法设置静态IP”。

---

### 📂 建议命名空间/类结构

```csharp
namespace NetworkConfigurator
{
    class Program
    {
        static void Main(string[] args) { ... }
    }

    class NetworkAdapterManager { ... }  // 负责获取、设置网卡配置
    class CommandLineParser { ... }      // 负责解析 --SetDNS 参数
}
```

---

此提示词结构清晰、目标明确，适合用于 Qwen-Coder 或其他 AI 编程助手，可引导其生成完整、健壮、符合 Windows 环境的 .NET Framework 命令行工具。

如需进一步扩展（如支持重置为DHCP、日志记录等），可在此基础上追加需求。